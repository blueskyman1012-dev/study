# 오답헌터 AI 문제 인식 수정 (2026-01-19)

## 문제점
- Gemini AI가 문제 사진을 인식하지 못하고 문제를 만들지 못함
- `analyzeImage` 함수가 있었지만 `completeRegister`에서 사용되지 않음
- 프롬프트가 너무 단순해서 정확한 JSON 응답을 받지 못함

---

## 수정 내용

### 1. GeminiService.js - `analyzeImage` 프롬프트 개선

**변경 전:**
```javascript
{ text: `이 ${subject} 문제 사진을 보고 JSON으로만 답해줘: {"question":"문제내용",...}` }
```

**변경 후:**
- 상세한 프롬프트 추가 (문제 분석 전문가 역할 부여)
- JSON 형식 명확하게 지정
- temperature 0.1로 낮춰 일관된 응답 유도
- MIME 타입 자동 감지 (jpeg, png, webp)
- 응답 검증 로직 추가

### 2. Game.js - `completeRegister` AI 분석 연동

**변경 전:**
- 항상 수동 입력만 사용

**변경 후:**
1. API 키가 있으면 AI 분석 먼저 시도
2. "AI 분석 중..." 화면 표시
3. 분석 성공 시 사용자에게 결과 확인 요청
4. 사용자가 수정 원하면 수정 가능
5. 분석 실패 시 수동 입력으로 폴백

---

## 수정된 파일

| 파일 | 변경 내용 |
|------|-----------|
| `src/services/GeminiService.js` | analyzeImage 프롬프트 개선, 응답 검증 추가 |
| `src/game/Game.js` | completeRegister에서 AI 분석 호출 |

---

## 동작 흐름

```
사진 촬영 → 과목 선택 → AI 분석 시도
                           ↓
                  [성공] → 결과 확인 → 등록
                           ↓
                  [실패] → 수동 입력 → 등록
```

---

## 테스트 방법

1. 설정에서 Gemini API 키 입력
2. 오답 등록 버튼 클릭
3. 문제 사진 촬영
4. 과목 선택
5. "AI 분석 중..." 화면 확인
6. AI 분석 결과 확인 팝업
7. 확인/수정 후 등록

---

## 주의사항

- API 키가 없으면 기존처럼 수동 입력 모드로 동작
- AI 분석 실패 시 에러 메시지와 함께 수동 입력 폴백
- 이미지 품질이 좋을수록 인식률 향상
