# 통계 화면 품질 개선

## 날짜
2026-02-09

## 개요
StatsScreen을 단순 4개 카드(87줄)에서 8개 섹션의 프리미엄 통계 화면으로 업그레이드.
스크롤 지원, 아크 링, 스파크라인 그래프, 미니카드 등 시각적으로 풍부한 대시보드 구현.

## 수정 파일

### 1. `app/src/game/StatsManager.js`
- aggregateStats()에 새 메트릭 추가:
  - 승률 (winRate)
  - 시간 통계 (totalPlayTime, avgRunDuration, longestRun, shortestClear)
  - 연승 (currentStreak, bestStreak)
  - 최근 10런 (recentRuns[])
  - 최근 승률/정답률 (recentWinRate, recentAccuracy)
  - 과목별 정답률 (subjectAccuracy)
  - 난이도별 정답률 (difficultyAccuracy)
  - 평균값 (avgAccuracy, avgGoldPerRun, totalDefeated)

### 2. `app/src/i18n/i18n.js`
- ko/en/ja/zh 4개 언어에 stats_ 접두사 번역 키 35개 추가

### 3. `app/src/game/Game.js`
- SCREENS.STATS 케이스에 스크롤 지원 추가 (AchievementScreen 패턴)
- ctx.save() → translate(0, -scrollY) → renderStatsScreen → ctx.restore()
- 고정 헤더 + 스크롤바 인디케이터

### 4. `app/src/game/screens/StatsScreen.js` (전체 재작성)
- 8개 섹션, 총 ~1420px 높이 스크롤 화면:

| 섹션 | y | 높이 | 내용 |
|------|---|------|------|
| A. 히어로 배너 | 75 | 180 | 큰 승률 아크링 + 총런/정답률/최고콤보 3열 |
| B. 연승 & 시간 | 270 | 90 | 2개 사이드 미니카드 |
| C. 과목별 성과 | 375 | 220 | 과목별 소형 정답률 링 + 바차트 |
| D. 난이도 분석 | 610 | 160 | 3난이도 그라데이션 바 + 정답률 |
| E. 플레이 기록 | 785 | 130 | 2×2 미니카드 (클리어/실패/콤보/골드) |
| F. 최근 전적 | 930 | 280 | 정답률 스파크라인 그래프 + 최근 런 목록 |
| G. 심화 통계 | 1225 | 140 | 평균정답률/평균골드/최단클리어/최장런/총처치 |
| H. 하단 여백 | 1380 | 40 | 스크롤 패딩 |

## 핵심 비주얼 요소
- **승률 아크링**: Canvas arc() + stroke, 반경 45, 두께 10
- **과목별 소형 링**: 반경 16, 두께 4
- **스파크라인**: 최근 10런 꺾은선 + 그라데이션 면적
- **그라데이션 바**: 난이도별 2색 그라데이션
- **빈 상태 처리**: totalRuns === 0일 때 안내 메시지

## 검증
- `npx vitest run` → 109개 테스트 전체 통과
- `npx vite build` → 빌드 성공 (220KB)
