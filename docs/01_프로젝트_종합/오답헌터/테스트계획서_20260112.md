# 오답헌터 - 테스트 계획서

> HTML5 + Canvas + Node.js 기반 웹 게임 테스트

---

## 1. 테스트 개요

| 항목 | 내용 |
|------|------|
| 프로젝트 | 오답헌터 (Odap Hunter) |
| 버전 | 1.0.0 |
| 테스트 유형 | 단위, 통합, E2E, 성능, 크로스브라우저 |
| 대상 환경 | Chrome, Safari, Firefox, Mobile |

---

## 2. 테스트 도구

| 도구 | 용도 | 설치 명령어 |
|------|------|-------------|
| Vitest | 단위 테스트 | `npm install -D vitest` |
| Playwright | E2E 테스트 | `npm install -D @playwright/test` |
| Lighthouse | 성능 측정 | Chrome DevTools 내장 |
| Chrome DevTools | 디버깅, 메모리 | 브라우저 내장 |

---

## 3. Phase별 테스트 계획

---

### Phase 1: 환경 설정 테스트

#### 1-1. 개발 서버 테스트

| ID | 테스트 항목 | 예상 결과 | 통과 기준 |
|----|-------------|-----------|-----------|
| P1-01 | `npm run dev` 실행 | Vite 서버 시작 | localhost:3000 접속 가능 |
| P1-02 | HMR (Hot Module Replacement) | 코드 수정 시 자동 반영 | 새로고침 없이 변경 적용 |
| P1-03 | `npm run build` 실행 | dist 폴더 생성 | 빌드 에러 없음 |
| P1-04 | `npm run preview` 실행 | 프로덕션 빌드 미리보기 | 정상 렌더링 |

#### 1-2. 폴더 구조 검증

```
[체크리스트]
□ index.html 존재
□ src/main.js 존재
□ src/style.css 존재
□ public/ 폴더 존재
□ vite.config.js 설정 정상
□ package.json scripts 정상
```

---

### Phase 2: 기본 게임 테스트

#### 2-1. Canvas 초기화 테스트

| ID | 테스트 항목 | 테스트 방법 | 예상 결과 |
|----|-------------|-------------|-----------|
| P2-01 | Canvas 생성 | 페이지 로드 후 확인 | gameCanvas 요소 존재 |
| P2-02 | Canvas 크기 | 리사이즈 후 확인 | 400x700 비율 유지 |
| P2-03 | 2D Context 획득 | getContext('2d') 호출 | null 아님 |
| P2-04 | 반응형 리사이즈 | 창 크기 변경 | Canvas 크기 조정됨 |

**테스트 코드 예시:**
```javascript
// tests/canvas.test.js
import { describe, it, expect, beforeEach } from 'vitest';

describe('Canvas 초기화', () => {
  beforeEach(() => {
    document.body.innerHTML = '<canvas id="gameCanvas"></canvas>';
  });

  it('Canvas 요소가 존재해야 함', () => {
    const canvas = document.getElementById('gameCanvas');
    expect(canvas).not.toBeNull();
  });

  it('2D Context를 획득해야 함', () => {
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    expect(ctx).not.toBeNull();
  });
});
```

#### 2-2. Renderer 모듈 테스트

| ID | 테스트 항목 | 입력 | 예상 결과 |
|----|-------------|------|-----------|
| P2-05 | clear() | - | 화면 검정색 채움 |
| P2-06 | drawGrid() | - | 그리드 라인 표시 |
| P2-07 | roundRect() | x, y, w, h, r, fill | 둥근 사각형 렌더링 |
| P2-08 | drawHPBar() | current=50, max=100 | 50% 채워진 HP바 |
| P2-09 | drawText() | "테스트", 100, 100 | 텍스트 렌더링 |

#### 2-3. IndexedDB 테스트

| ID | 테스트 항목 | 테스트 방법 | 예상 결과 |
|----|-------------|-------------|-----------|
| P2-10 | DB 열기 | open() 호출 | Promise 성공 |
| P2-11 | 스토어 생성 | DB 초기화 | player, monsters, items, runs, settings 스토어 존재 |
| P2-12 | 데이터 추가 | add('monsters', {...}) | ID 반환 |
| P2-13 | 데이터 조회 | get('player', 'main') | 데이터 객체 반환 |
| P2-14 | 데이터 수정 | put('player', {...}) | 업데이트 성공 |
| P2-15 | 데이터 삭제 | delete('monsters', 1) | 삭제 성공 |
| P2-16 | 인덱스 조회 | getByIndex('monsters', 'status', 'alive') | 필터링된 배열 |

**테스트 코드 예시:**
```javascript
// tests/database.test.js
import { describe, it, expect, beforeEach, afterEach } from 'vitest';
import { Database } from '../src/data/Database.js';

describe('IndexedDB', () => {
  let db;

  beforeEach(async () => {
    db = new Database();
    await db.open();
  });

  afterEach(() => {
    indexedDB.deleteDatabase('OdapHunterDB');
  });

  it('몬스터를 추가해야 함', async () => {
    const monster = { subject: 'math', hp: 100, status: 'alive' };
    const id = await db.add('monsters', monster);
    expect(id).toBeGreaterThan(0);
  });

  it('상태별로 몬스터를 조회해야 함', async () => {
    await db.add('monsters', { subject: 'math', status: 'alive' });
    await db.add('monsters', { subject: 'english', status: 'defeated' });

    const alive = await db.getByIndex('monsters', 'status', 'alive');
    expect(alive.length).toBe(1);
  });
});
```

#### 2-4. 오답 등록 테스트

| ID | 테스트 항목 | 테스트 방법 | 예상 결과 |
|----|-------------|-------------|-----------|
| P2-17 | 이미지 캡처 | 파일 선택 | Base64 데이터 반환 |
| P2-18 | 몬스터 생성 | 폼 입력 후 저장 | IndexedDB에 저장됨 |
| P2-19 | 과목 선택 | 과목 입력 | subject 필드 저장 |
| P2-20 | 등록 토스트 | 등록 완료 | "몬스터가 등록되었습니다!" 표시 |

---

### Phase 3: 전투 시스템 테스트

#### 3-1. 전투 화면 테스트

| ID | 테스트 항목 | 테스트 방법 | 예상 결과 |
|----|-------------|-------------|-----------|
| P3-01 | 전투 화면 진입 | 던전 입장 클릭 | BattleScreen 렌더링 |
| P3-02 | 몬스터 표시 | 전투 시작 | 몬스터 이미지/이름 표시 |
| P3-03 | HP바 표시 | 전투 시작 | 플레이어/몬스터 HP바 표시 |
| P3-04 | 문제 표시 | 전투 시작 | 문제 텍스트/이미지 표시 |
| P3-05 | 선택지 표시 | 전투 시작 | 4개 선택지 버튼 표시 |
| P3-06 | 타이머 표시 | 전투 시작 | 카운트다운 시작 |

#### 3-2. 정답/오답 판정 테스트

| ID | 테스트 항목 | 입력 | 예상 결과 |
|----|-------------|------|-----------|
| P3-07 | 정답 선택 | 정답 클릭 | 몬스터 HP 감소 |
| P3-08 | 오답 선택 | 오답 클릭 | 플레이어 HP 감소 |
| P3-09 | 시간 초과 | 타이머 0 | 플레이어 HP 감소 |
| P3-10 | 몬스터 처치 | 몬스터 HP 0 | 스테이지 클리어 |
| P3-11 | 플레이어 사망 | 플레이어 HP 0 | 런 종료, 결과 화면 |

**테스트 코드 예시:**
```javascript
// tests/battle.test.js
import { describe, it, expect } from 'vitest';
import { Battle } from '../src/game/Battle.js';
import { Player } from '../src/game/Player.js';

describe('전투 시스템', () => {
  it('정답 시 몬스터 HP가 감소해야 함', () => {
    const player = new Player({ maxHp: 100, level: 1 });
    const monster = { hp: 100, maxHp: 100 };
    const battle = new Battle(player, { monsters: [monster] });

    battle.submitAnswer(true); // 정답

    expect(monster.hp).toBeLessThan(100);
  });

  it('오답 시 플레이어 HP가 감소해야 함', () => {
    const player = new Player({ maxHp: 100, level: 1 });
    const monster = { hp: 100, maxHp: 100 };
    const battle = new Battle(player, { monsters: [monster] });

    const initialHp = player.currentHp;
    battle.submitAnswer(false); // 오답

    expect(player.currentHp).toBeLessThan(initialHp);
  });
});
```

#### 3-3. 콤보 시스템 테스트

| ID | 테스트 항목 | 입력 | 예상 결과 |
|----|-------------|------|-----------|
| P3-12 | 콤보 증가 | 연속 정답 3회 | combo = 3, 배수 = 1.2 |
| P3-13 | 콤보 리셋 | 오답 1회 | combo = 0 |
| P3-14 | 최대 콤보 | 연속 정답 20회 | 배수 = 3.0 (MAX) |
| P3-15 | 콤보 보너스 골드 | 콤보 5 달성 | 골드 +50% |

#### 3-4. 스테이지 진행 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P3-16 | 스테이지 클리어 | 몬스터 HP 0 | 다음 스테이지로 |
| P3-17 | 보스 스테이지 | 스테이지 10 | 보스 등장 |
| P3-18 | 던전 클리어 | 보스 처치 | 결과 화면 + 보상 |
| P3-19 | 난이도 증가 | 스테이지 진행 | 문제 난이도 상승 |

#### 3-5. 힌트/스킵 테스트

| ID | 테스트 항목 | 입력 | 예상 결과 |
|----|-------------|------|-----------|
| P3-20 | 힌트 사용 | 힌트 버튼 클릭 | 50G 차감, 힌트 표시 |
| P3-21 | 힌트 골드 부족 | 잔액 < 50G | "골드 부족" 메시지 |
| P3-22 | 스킵 기능 | 스킵 버튼 클릭 | 문제 건너뛰기, HP 감소 |
| P3-23 | 일시정지 | 일시정지 버튼 | 타이머 정지, 문제 가림 |

#### 3-6. 복습 기한 → 몬스터 강화 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P3-24 | 0~3일 경과 | createdAt 3일 이내 | HP = 100 (일반) |
| P3-25 | 4~7일 경과 | createdAt 4~7일 | HP = 150 (강화) |
| P3-26 | 8~14일 경과 | createdAt 8~14일 | HP = 200 (분노) |
| P3-27 | 15일+ 경과 | createdAt 15일 이상 | HP = 300 (보스급) |

#### 3-7. 적응형 난이도 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P3-28 | 난이도 상승 | 최근 10문제 정답률 90%+ | 난이도 UP |
| P3-29 | 난이도 유지 | 정답률 70~90% | 난이도 유지 |
| P3-30 | 힌트 제공 | 정답률 50~70% | 자동 힌트 제공 |
| P3-31 | 난이도 하락 | 정답률 50% 미만 | 난이도 DOWN |

---

### Phase 4: 로그라이크 시스템 테스트

#### 4-1. 버프 선택 테스트

| ID | 테스트 항목 | 테스트 방법 | 예상 결과 |
|----|-------------|-------------|-----------|
| P4-01 | 버프 선택 UI | 스테이지 클리어 | 3개 버프 옵션 표시 |
| P4-02 | 공격 버프 | 공격 +20% 선택 | 데미지 증가 |
| P4-03 | 방어 버프 | +1 목숨 선택 | 추가 목숨 획득 |
| P4-04 | 시간 버프 | +10초 선택 | 제한시간 증가 |
| P4-05 | 버프 중첩 | 같은 버프 2회 | 효과 누적 |
| P4-06 | 런 종료 시 버프 초기화 | 사망 후 재시작 | 임시 버프 사라짐 |

#### 4-2. 영구 강화 테스트

| ID | 테스트 항목 | 입력 | 예상 결과 |
|----|-------------|------|-----------|
| P4-07 | 강화 상점 표시 | 런 종료 후 | 영구 강화 목록 표시 |
| P4-08 | HP 강화 구매 | 200G 지불 | 기본 HP +10 |
| P4-09 | 시간 강화 구매 | 150G 지불 | 시작 시간 +5초 |
| P4-10 | 골드 보너스 구매 | 300G 지불 | 골드 획득량 +10% |
| P4-11 | 골드 부족 | 잔액 < 가격 | 구매 불가, 메시지 표시 |
| P4-12 | 강화 영구 저장 | 구매 후 재시작 | 강화 효과 유지 |

#### 4-3. 경험치/레벨 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P4-13 | 경험치 획득 | 몬스터 처치 | exp 증가 |
| P4-14 | 레벨업 | exp >= 필요 경험치 | level +1 |
| P4-15 | 레벨업 스탯 증가 | 레벨업 시 | HP, 시간 보너스 증가 |
| P4-16 | 경험치 공식 | 레벨 5 | 필요 exp = 5*100 + 4*50 = 700 |

#### 4-4. 결과 화면 테스트

| ID | 테스트 항목 | 표시 항목 | 예상 결과 |
|----|-------------|-----------|-----------|
| P4-17 | 정답률 표시 | 8/10 정답 | "80%" 표시 |
| P4-18 | 평균 풀이 시간 | 각 문제 시간 | 평균 계산 후 표시 |
| P4-19 | 최고 콤보 | 최대 콤보 | "5연속" 표시 |
| P4-20 | 보상 내역 | 골드 계산 | 기본 + 타임 + 콤보 보너스 |
| P4-21 | 총 획득 골드 | 합계 | 정확한 합계 표시 |

#### 4-5. 랜덤 이벤트 테스트

| ID | 테스트 항목 | 이벤트 | 예상 결과 |
|----|-------------|--------|-----------|
| P4-22 | 상인 이벤트 | 50G 지불 선택 | 골드 차감 + 랜덤 버프 |
| P4-23 | 상인 무시 | 무시하기 선택 | 이벤트 종료 |
| P4-24 | 빛 이벤트 성공 | 조사 → 버프 | 50% 확률 버프 획득 |
| P4-25 | 빛 이벤트 함정 | 조사 → 함정 | 50% 확률 HP 감소 |
| P4-26 | 보물상자 골드 | 상자 열기 | 골드 획득 |
| P4-27 | 보물상자 몬스터 | 상자 열기 | 추가 전투 발생 |
| P4-28 | 휴식처 | 휴식 선택 | HP 30% 회복 |

#### 4-6. 타임 보너스 계산 테스트

| ID | 테스트 항목 | 풀이 시간 | 예상 결과 |
|----|-------------|-----------|-----------|
| P4-29 | 초고속 풀이 | 제한시간 30% 이내 | 보상 +100% (2배) |
| P4-30 | 고속 풀이 | 제한시간 50% 이내 | 보상 +50% |
| P4-31 | 보통 풀이 | 제한시간 80% 이내 | 보상 +20% |
| P4-32 | 느린 풀이 | 제한시간 초과 | 기본 보상만 |

---

### Phase 4-B: 아이템 시스템 테스트

#### 4B-1. 아이템 드랍 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P4B-01 | 보스 드랍 | 보스 처치 | 100% 아이템 드랍 |
| P4B-02 | 엘리트 드랍 | 스테이지 5, 8 엘리트 처치 | 30% 확률 드랍 |
| P4B-03 | 상자 드랍 | 보물상자 이벤트 | 20% 확률 드랍 |

#### 4B-2. 희귀도별 드랍률 테스트

| ID | 테스트 항목 | 희귀도 | 예상 드랍률 |
|----|-------------|--------|-------------|
| P4B-04 | 일반 아이템 | ⚪ 흰색 | 60% |
| P4B-05 | 레어 아이템 | 🔵 파랑 | 25% |
| P4B-06 | 에픽 아이템 | 🟣 보라 | 12% |
| P4B-07 | 전설 아이템 | 🟡 금색 | 3% |

#### 4B-3. 장비 슬롯 테스트

| ID | 테스트 항목 | 테스트 방법 | 예상 결과 |
|----|-------------|-------------|-----------|
| P4B-08 | 무기 장착 | 무기 슬롯에 아이템 장착 | 공격력/골드 효과 적용 |
| P4B-09 | 방어구 장착 | 방어구 슬롯에 장착 | HP/방어력 효과 적용 |
| P4B-10 | 악세서리 장착 | 악세서리 슬롯에 장착 | 특수 효과 적용 |
| P4B-11 | 장비 교체 | 기존 장비 → 새 장비 | 효과 교체, 기존 인벤토리로 |
| P4B-12 | 장비 해제 | 장비 해제 | 인벤토리로 이동 |

#### 4B-4. 세트 효과 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P4B-13 | 2세트 효과 | 같은 세트 2개 장착 | 2세트 보너스 발동 |
| P4B-14 | 3세트 효과 | 같은 세트 3개 장착 | 3세트 보너스 발동 |
| P4B-15 | 세트 해제 | 세트 아이템 1개 해제 | 세트 효과 비활성화 |

#### 4B-5. 아이템 강화 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P4B-16 | 중복 획득 | 동일 아이템 2개째 | 자동 강화 (+1) |
| P4B-17 | 강화 효과 증가 | +1 → +2 | 효과 수치 증가 |
| P4B-18 | 최대 강화 | +3 상태에서 중복 | +3 유지 (MAX) |

#### 4B-6. 컬렉션 도감 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P4B-19 | 도감 등록 | 새 아이템 획득 | 도감에 추가 |
| P4B-20 | 수집률 계산 | 34/120 획득 | "28%" 표시 |
| P4B-21 | 10% 보상 | 수집률 10% 달성 | 골드 +5% 보너스 |
| P4B-22 | 50% 보상 | 수집률 50% 달성 | 특별 칭호 해금 |
| P4B-23 | 100% 보상 | 수집률 100% 달성 | 히든 캐릭터 해금 |
| P4B-24 | 미획득 표시 | 미획득 아이템 | 실루엣(❓)으로 표시 |

---

### Phase 4-C: 캐릭터 시스템 테스트

#### 4C-1. 캐릭터 해금 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P4C-01 | 기본 용사 | 시작 | 기본 해금됨 |
| P4C-02 | 속도형 해금 | 300G 지불 | 해금, HP 70/시간 45초 |
| P4C-03 | 탱커형 해금 | 300G 지불 | 해금, HP 150/시간 20초 |
| P4C-04 | 도박형 해금 | 500G 지불 | 해금, 매 런 랜덤 스탯 |
| P4C-05 | 골드 부족 | 잔액 < 가격 | 해금 불가 메시지 |

#### 4C-2. 히든 캐릭터 해금 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P4C-06 | 올클리어 캐릭터 | 모든 던전 클리어 | 히든 캐릭터 해금 |
| P4C-07 | 수집가 캐릭터 | 도감 100% | 히든 캐릭터 해금 |
| P4C-08 | 콤보왕 캐릭터 | 50콤보 달성 | 히든 캐릭터 해금 |
| P4C-09 | 무피해 캐릭터 | 피해 0 보스 클리어 | 히든 캐릭터 해금 |

#### 4C-3. 캐릭터별 스탯 테스트

| ID | 테스트 항목 | 캐릭터 | 예상 스탯 |
|----|-------------|--------|-----------|
| P4C-10 | 기본 용사 스탯 | 기본 용사 | HP 100, 시간 30초 |
| P4C-11 | 속도형 스탯 | 속도형 | HP 70, 시간 45초 |
| P4C-12 | 탱커형 스탯 | 탱커형 | HP 150, 시간 20초 |
| P4C-13 | 도박형 스탯 | 도박형 | 매 런 랜덤 |

#### 4C-4. 던전 해금 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P4C-14 | 수학 던전 | 기본 | 항상 해금됨 |
| P4C-15 | 영어 던전 | LV.5 | 레벨 5 이상 시 해금 |
| P4C-16 | 국어 던전 | LV.10 | 레벨 10 이상 시 해금 |
| P4C-17 | 과학 던전 | LV.15 | 레벨 15 이상 시 해금 |
| P4C-18 | 혼합 던전 | LV.20 | 레벨 20 이상 시 해금 |
| P4C-19 | 잠금 표시 | 조건 미충족 | 🔒 표시 + 해금 조건 |

---

### Phase 5: AI 연동 테스트

#### 5-1. Express 서버 테스트

| ID | 테스트 항목 | 테스트 방법 | 예상 결과 |
|----|-------------|-------------|-----------|
| P5-01 | 서버 시작 | `npm run server` | localhost:4000 접속 가능 |
| P5-02 | 헬스체크 | GET /health | { status: 'ok' } |
| P5-03 | CORS 설정 | 다른 도메인에서 요청 | 요청 허용 |
| P5-04 | JSON 파싱 | POST body 전송 | 정상 파싱 |

#### 5-2. AI API 테스트

| ID | 테스트 항목 | 엔드포인트 | 예상 결과 |
|----|-------------|------------|-----------|
| P5-05 | 문제 생성 | POST /api/generate | { question, choices, answer, explanation } |
| P5-06 | 힌트 생성 | POST /api/hint | { hint: "..." } |
| P5-07 | 오답 분석 | POST /api/analyze | { analysis: "..." } |
| P5-08 | API 키 누락 | 키 없이 요청 | 500 에러 + 메시지 |
| P5-09 | 타임아웃 | 30초 초과 | 타임아웃 에러 |

#### 5-3. OCR 테스트

| ID | 테스트 항목 | 입력 | 예상 결과 |
|----|-------------|------|-----------|
| P5-10 | 인쇄체 인식 | 교과서 사진 | 90%+ 정확도 텍스트 추출 |
| P5-11 | 손글씨 인식 | 손글씨 노트 사진 | 70%+ 정확도 (경고 표시) |
| P5-12 | 수식 인식 | 수학 문제 사진 | LaTeX 형식 변환 |
| P5-13 | 이미지 전처리 | 어두운 사진 | 자동 밝기/대비 조정 |
| P5-14 | 회전 보정 | 기울어진 사진 | 자동 회전 보정 |
| P5-15 | OCR 결과 수정 | 사용자 수정 | 수정된 텍스트 저장 |

#### 5-4. 문제 유형 자동 분류 테스트

| ID | 테스트 항목 | 입력 | 예상 결과 |
|----|-------------|------|-----------|
| P5-16 | 과목 분류 | 수학 문제 텍스트 | subject: "math" |
| P5-17 | 대단원 분류 | 이차방정식 문제 | category: "대수" |
| P5-18 | 소단원 분류 | 판별식 문제 | subcategory: "이차방정식" |
| P5-19 | 유형 분류 | 특정 유형 | type: "판별식 활용" |
| P5-20 | 신뢰도 표시 | 분류 결과 | confidence: 92% |
| P5-21 | 수동 분류 폴백 | 신뢰도 < 70% | 사용자 선택 UI 표시 |

#### 5-5. 오답 패턴 분석 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P5-22 | 취약 단원 분석 | 오답 30개 이상 | TOP 3 취약 단원 표시 |
| P5-23 | 실수 유형 분석 | 오답 기록 | 부호/조건/시간 실수 비율 |
| P5-24 | 시간대별 분석 | 플레이 기록 | 시간대별 정답률 |
| P5-25 | 맞춤형 추천 | 분석 결과 | 집중 복습 단원 추천 |

#### 5-6. 단계별 힌트 테스트

| ID | 테스트 항목 | 힌트 단계 | 예상 결과 |
|----|-------------|-----------|-----------|
| P5-26 | 힌트 1단계 | 무료 힌트 | 풀이 방향 제시 |
| P5-27 | 힌트 2단계 | 30G | 더 구체적인 힌트 |
| P5-28 | 정답 해설 | 80G | 전체 풀이 과정 표시 |
| P5-29 | 힌트 순차 해금 | 1단계 미사용 | 2단계 비활성화 |

#### 5-7. 오프라인 모드 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| P5-30 | 오프라인 전투 | 네트워크 끊김 | 기본 전투 가능 |
| P5-31 | 캐시된 힌트 | 이전 사용 힌트 | 오프라인에서도 표시 |
| P5-32 | AI 기능 비활성화 | 오프라인 | "온라인 필요" 메시지 |
| P5-33 | 온라인 복귀 동기화 | 네트워크 재연결 | 자동 동기화 |
| P5-34 | 폴백 로직 | AI 서비스 장애 | 기본 기능 유지 |

**API 테스트 예시:**
```javascript
// tests/api.test.js
import { describe, it, expect } from 'vitest';

describe('AI API', () => {
  const API_URL = 'http://localhost:4000';

  it('헬스체크가 성공해야 함', async () => {
    const res = await fetch(`${API_URL}/health`);
    const data = await res.json();
    expect(data.status).toBe('ok');
  });

  it('힌트를 생성해야 함', async () => {
    const res = await fetch(`${API_URL}/api/hint`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ question: 'x² - 5x + 6 = 0을 풀어라' })
    });
    const data = await res.json();
    expect(data.hint).toBeDefined();
  });
});
```

---

## 4. UI/UX 테스트

### 4-1. 화면별 테스트

| 화면 | 테스트 항목 | 확인 사항 |
|------|-------------|-----------|
| 메인 | 레이아웃 | 레벨, 골드, 버튼 위치 정상 |
| 메인 | 클릭 영역 | 던전 입장, 오답 등록 버튼 동작 |
| 전투 | HP바 | 실시간 업데이트 |
| 전투 | 선택지 | 터치/클릭 반응 |
| 결과 | 보상 애니메이션 | 골드 증가 애니메이션 |
| 상점 | 구매 버튼 | 구매 가능/불가능 표시 |

### 4-2. 반응형 테스트

| 디바이스 | 해상도 | 확인 사항 |
|----------|--------|-----------|
| iPhone SE | 375x667 | Canvas 비율 유지 |
| iPhone 14 | 390x844 | 터치 영역 정상 |
| iPad | 768x1024 | 화면 중앙 정렬 |
| Desktop | 1920x1080 | 컨테이너 내 표시 |

### 4-3. 색상/분위기 테스트

```
[체크리스트]
□ 배경색 #0a0a0f (다크)
□ 강조색 #6366f1 (보라/네온)
□ 텍스트 #e2e8f0 (밝은 회색)
□ HP바 색상 (초록 → 빨강 변화)
□ 전설 아이템 금색 #fbbf24
□ 그리드 라인 미세하게 보임
```

---

## 5. 성능 테스트

### 5-1. 렌더링 성능

| ID | 테스트 항목 | 측정 방법 | 목표 |
|----|-------------|-----------|------|
| PF-01 | FPS | requestAnimationFrame | 60fps 유지 |
| PF-02 | 프레임 드랍 | Chrome DevTools | 드랍 없음 |
| PF-03 | 메모리 사용량 | DevTools Memory | < 50MB |
| PF-04 | Canvas 렌더링 | Performance 탭 | < 16ms/프레임 |

### 5-2. 로딩 성능

| ID | 테스트 항목 | 측정 방법 | 목표 |
|----|-------------|-----------|------|
| PF-05 | 초기 로딩 | Lighthouse | < 3초 |
| PF-06 | 번들 크기 | build 후 확인 | < 500KB |
| PF-07 | 이미지 로딩 | 첫 화면 표시 | < 1초 |
| PF-08 | IndexedDB 열기 | 측정 | < 100ms |

### 5-3. Lighthouse 점수

| 항목 | 목표 점수 |
|------|-----------|
| Performance | > 90 |
| Accessibility | > 90 |
| Best Practices | > 90 |
| SEO | > 80 |

---

## 6. 크로스브라우저 테스트

### 6-1. 브라우저 호환성

| 브라우저 | 버전 | 테스트 항목 |
|----------|------|-------------|
| Chrome | 최신 | 전체 기능 |
| Safari | 최신 | Canvas, IndexedDB |
| Firefox | 최신 | 전체 기능 |
| Edge | 최신 | 전체 기능 |
| Samsung Internet | 최신 | 모바일 터치 |

### 6-2. 브라우저별 체크리스트

```
[Chrome]
□ Canvas 렌더링
□ IndexedDB CRUD
□ 터치 이벤트
□ 파일 선택 (카메라)

[Safari]
□ Canvas 렌더링
□ IndexedDB (프라이빗 모드 제한 확인)
□ 터치 이벤트
□ Safe Area 대응

[Firefox]
□ Canvas 렌더링
□ IndexedDB CRUD
□ requestAnimationFrame

[모바일]
□ 터치 정확도
□ 화면 회전 대응
□ 가상 키보드 대응
```

---

## 7. 에러 처리 테스트

| ID | 시나리오 | 예상 동작 |
|----|----------|-----------|
| E-01 | IndexedDB 지원 안 함 | 에러 메시지 표시 |
| E-02 | 이미지 로드 실패 | 대체 이미지 표시 |
| E-03 | AI API 타임아웃 | "다시 시도" 버튼 |
| E-04 | 네트워크 오프라인 | 오프라인 모드 알림 |
| E-05 | 저장 공간 부족 | 저장 실패 알림 |
| E-06 | 브라우저 탭 비활성 | 게임 일시정지 |

---

## 8. 데이터 무결성 테스트

| ID | 테스트 항목 | 테스트 방법 | 예상 결과 |
|----|-------------|-------------|-----------|
| D-01 | 플레이어 데이터 저장 | 게임 종료 후 재접속 | 데이터 유지 |
| D-02 | 몬스터 상태 동기화 | 처치 후 재접속 | status = 'defeated' |
| D-03 | 골드 계산 정확성 | 보상 지급 후 확인 | 정확한 합계 |
| D-04 | 경험치 누적 | 여러 런 후 확인 | 누적 저장 |
| D-05 | 영구 강화 저장 | 구매 후 재접속 | 강화 유지 |
| D-06 | 런 기록 저장 | 런 종료 후 | runs 스토어에 저장 |

---

## 9. 테스트 실행 명령어

```bash
# 단위 테스트
npm run test

# 특정 파일 테스트
npm run test -- tests/database.test.js

# 커버리지 측정
npm run test:coverage

# E2E 테스트
npm run test:e2e

# Watch 모드
npm run test:watch
```

---

## 10. package.json 테스트 스크립트

```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "test": "vitest run",
    "test:watch": "vitest",
    "test:coverage": "vitest run --coverage",
    "test:e2e": "playwright test"
  },
  "devDependencies": {
    "vite": "^5.0.0",
    "vitest": "^1.0.0",
    "@playwright/test": "^1.40.0",
    "@vitest/coverage-v8": "^1.0.0"
  }
}
```

---

## 11. 테스트 결과 템플릿

### 테스트 실행 기록

| 날짜 | 버전 | 통과 | 실패 | 스킵 | 담당자 |
|------|------|------|------|------|--------|
| YYYY-MM-DD | 1.0.0 | - | - | - | - |

### 버그 리포트 템플릿

```
[버그 ID] BUG-001

[제목]
간단한 버그 설명

[재현 단계]
1.
2.
3.

[예상 결과]


[실제 결과]


[환경]
- 브라우저:
- OS:
- 디바이스:

[스크린샷]

[심각도] Critical / High / Medium / Low

[상태] Open / In Progress / Resolved / Closed
```

---

## 12. 테스트 완료 기준

### MVP 출시 전 필수

- [ ] Phase 1~4 전체 테스트 통과
- [ ] 주요 브라우저 (Chrome, Safari, Firefox) 호환성 확인
- [ ] 모바일 기기 터치 테스트 통과
- [ ] Lighthouse Performance > 80
- [ ] Critical/High 버그 0건
- [ ] 데이터 무결성 테스트 통과

### 품질 목표

| 항목 | 목표 |
|------|------|
| 테스트 커버리지 | > 70% |
| 버그 수정률 | 100% (Critical/High) |
| 평균 응답 시간 | < 100ms |
| 크래시 발생률 | 0% |

---

## 13. 통합 테스트 (E2E)

### 13-1. 전체 게임 플로우 테스트

| ID | 테스트 시나리오 | 단계 | 예상 결과 |
|----|-----------------|------|-----------|
| E2E-01 | 신규 사용자 플로우 | 앱 시작 → 오답 등록 → 던전 입장 → 전투 → 결과 | 전체 흐름 정상 |
| E2E-02 | 레벨업 플로우 | 전투 반복 → 경험치 획득 → 레벨업 | 레벨업 정상, 스탯 증가 |
| E2E-03 | 아이템 획득 플로우 | 보스 처치 → 아이템 드랍 → 장착 | 아이템 효과 적용 |
| E2E-04 | 영구 강화 플로우 | 런 종료 → 골드 획득 → 강화 구매 → 재시작 | 강화 효과 유지 |
| E2E-05 | 캐릭터 변경 플로우 | 캐릭터 해금 → 선택 → 던전 입장 | 캐릭터 스탯 적용 |

### 13-2. Playwright E2E 테스트 예시

```javascript
// tests/e2e/game-flow.spec.js
import { test, expect } from '@playwright/test';

test('신규 사용자 전체 플로우', async ({ page }) => {
  await page.goto('http://localhost:3000');

  // 메인 화면 로드 확인
  await expect(page.locator('#gameCanvas')).toBeVisible();

  // 오답 등록
  await page.click('text=오답 등록');

  // 던전 입장
  await page.click('text=던전 입장');

  // 전투 화면 확인
  await expect(page.locator('text=스테이지')).toBeVisible();
});
```

---

## 14. 보안 테스트

### 14-1. 입력 검증 테스트

| ID | 테스트 항목 | 입력 | 예상 결과 |
|----|-------------|------|-----------|
| SEC-01 | XSS 방지 | `<script>alert(1)</script>` | 스크립트 실행 안 됨 |
| SEC-02 | SQL Injection | `'; DROP TABLE--` | 에러 없이 무시 |
| SEC-03 | 특수문자 처리 | `<>&"'` | 이스케이프 처리 |
| SEC-04 | 긴 입력 | 10000자 문자열 | 적절히 잘림/거부 |

### 14-2. 데이터 보안 테스트

| ID | 테스트 항목 | 확인 사항 |
|----|-------------|-----------|
| SEC-05 | 로컬 데이터 | IndexedDB 데이터 암호화 여부 |
| SEC-06 | API 키 노출 | 클라이언트에서 API 키 접근 불가 |
| SEC-07 | 콘솔 로그 | 민감 정보 콘솔 출력 없음 |
| SEC-08 | 소스맵 | 프로덕션에서 소스맵 비활성화 |

---

## 15. 접근성 테스트

### 15-1. 접근성 체크리스트

```
[시각]
□ 색상 대비 비율 4.5:1 이상
□ 색상만으로 정보 전달 안 함
□ 텍스트 크기 조절 가능
□ 화면 확대 200%에서도 사용 가능

[조작]
□ 터치 타겟 최소 44x44px
□ 버튼 간격 충분
□ 실수 취소 가능

[인지]
□ 명확한 에러 메시지
□ 진행 상태 표시
□ 일관된 네비게이션
```

---

## 16. PWA 테스트

### 16-1. PWA 요구사항 테스트

| ID | 테스트 항목 | 확인 사항 | 통과 기준 |
|----|-------------|-----------|-----------|
| PWA-01 | manifest.json | 파일 존재 및 유효성 | 필수 필드 포함 |
| PWA-02 | 앱 아이콘 | 192x192, 512x512 | 아이콘 표시됨 |
| PWA-03 | 홈 화면 추가 | 설치 프롬프트 | 프롬프트 표시 |
| PWA-04 | 오프라인 지원 | 네트워크 끊김 | 기본 화면 표시 |
| PWA-05 | 스플래시 화면 | 앱 시작 | 스플래시 표시 |

### 16-2. Service Worker 테스트

| ID | 테스트 항목 | 조건 | 예상 결과 |
|----|-------------|------|-----------|
| PWA-06 | SW 등록 | 첫 로드 | navigator.serviceWorker 활성화 |
| PWA-07 | 캐싱 | 리소스 요청 | 캐시에서 응답 |
| PWA-08 | 업데이트 | 새 버전 배포 | 업데이트 알림 |

---

## 17. 배포 테스트

### 17-1. 빌드 테스트

| ID | 테스트 항목 | 명령어 | 예상 결과 |
|----|-------------|--------|-----------|
| DEP-01 | 프로덕션 빌드 | `npm run build` | 에러 없이 완료 |
| DEP-02 | 번들 크기 | 빌드 후 확인 | < 500KB |
| DEP-03 | 에셋 최적화 | 이미지 확인 | 압축됨 |
| DEP-04 | 소스맵 | dist 폴더 확인 | .map 파일 없음 |

### 17-2. 배포 환경 테스트

| 플랫폼 | 테스트 항목 | 확인 사항 |
|--------|-------------|-----------|
| Vercel | 자동 배포 | git push 후 배포 완료 |
| Vercel | 환경 변수 | API 키 설정 확인 |
| Vercel | 커스텀 도메인 | HTTPS 적용 |
| Netlify | 빌드 설정 | vite build 정상 |

### 17-3. 배포 체크리스트

```
[배포 전]
□ 모든 테스트 통과
□ 환경 변수 설정
□ 빌드 성공
□ 번들 크기 확인

[배포 후]
□ 사이트 접속 확인
□ 주요 기능 동작 확인
□ 콘솔 에러 없음
□ 모바일 접속 확인
□ PWA 설치 가능
```

---

## 18. 클래스별 단위 테스트

### 18-1. Player 클래스 테스트

| ID | 테스트 항목 | 메서드 | 예상 결과 |
|----|-------------|--------|-----------|
| U-01 | 플레이어 생성 | constructor | 기본 스탯 설정 |
| U-02 | 데미지 받기 | takeDamage(20) | currentHp -= 20 |
| U-03 | 경험치 획득 | gainExp(100) | exp += 100 |
| U-04 | 레벨업 | levelUp() | level += 1, 스탯 증가 |
| U-05 | 골드 획득 | gainGold(50) | gold += 50 |

### 18-2. Monster 클래스 테스트

| ID | 테스트 항목 | 메서드 | 예상 결과 |
|----|-------------|--------|-----------|
| U-06 | 몬스터 생성 | constructor | HP, subject 설정 |
| U-07 | 데미지 받기 | takeDamage(33) | hp -= 33 |
| U-08 | 처치 판정 | isDefeated() | hp <= 0 시 true |
| U-09 | 복습 기한 HP | calculateHp() | 기한 경과에 따른 HP |

### 18-3. Dungeon 클래스 테스트

| ID | 테스트 항목 | 메서드 | 예상 결과 |
|----|-------------|--------|-----------|
| U-10 | 던전 생성 | constructor | 스테이지 10개 생성 |
| U-11 | 다음 스테이지 | nextStage() | currentStage += 1 |
| U-12 | 보스 확인 | isBossStage() | stage 10 시 true |
| U-13 | 던전 완료 | isCompleted() | 보스 처치 시 true |

### 18-4. EventBus 테스트

| ID | 테스트 항목 | 메서드 | 예상 결과 |
|----|-------------|--------|-----------|
| U-14 | 이벤트 등록 | on('event', fn) | 리스너 등록됨 |
| U-15 | 이벤트 발행 | emit('event', data) | 리스너 호출됨 |
| U-16 | 이벤트 해제 | off('event', fn) | 리스너 제거됨 |

---

## 관련 문서

- [웹 개발 계획서](./html_개발계획.md)
- [게임 설계서](../../오답헌터/오답헌터_핵심설계_20260112.md)
- [시스템 설계서](../../오답헌터/오답헌터_시스템설계_20260112.md)
- [AI 기능 설계서](../../오답헌터/오답헌터_AI기능_20260112.md)
- [개발 계획서](../../오답헌터/오답헌터_개발계획_20260112.md)
