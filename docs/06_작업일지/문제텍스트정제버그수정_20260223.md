# ë¬¸ì œ í…ìŠ¤íŠ¸ ì •ì œ ë²„ê·¸ ìˆ˜ì •

## ì‘ì—…ì¼: 2026-02-23

## ë¬¸ì œ í˜„ìƒ
AI(Gemini/SmilePrint)ê°€ ìƒì„±í•œ ë¬¸ì œ í…ìŠ¤íŠ¸ì— ì˜ì–´ ì£¼ì„, ê´„í˜¸ ë©”íƒ€ë°ì´í„°, ë§ˆí¬ë‹¤ìš´ ì„œì‹, ë²ˆí˜¸ ì ‘ë‘ì–´ ë“±ì´ ì„ì—¬ ê²Œì„ ë‚´ ë¬¸ì œê°€ ì´ìƒí•˜ê²Œ í‘œì‹œë¨.

### ì›ì¸
- AI í”„ë¡¬í”„íŠ¸ì— í•œêµ­ì–´ ì „ìš© ì¶œë ¥ ê·œì¹™ ì—†ìŒ
- íŒŒì‹± í›„ í…ìŠ¤íŠ¸ ì •ì œ ë¡œì§ ì—†ìŒ
- AI ì¶œë ¥ì´ ê·¸ëŒ€ë¡œ ì €ì¥/í‘œì‹œë¨

## ìˆ˜ì • ë‚´ìš©

### 1. í…ìŠ¤íŠ¸ ì •ì œ ìœ í‹¸ í•¨ìˆ˜ ì¶”ê°€
- **íŒŒì¼**: `app/src/utils/textCleaner.js` (ì‹ ê·œ)
- `cleanQuestionText()` í•¨ìˆ˜ êµ¬í˜„
- ì •ì œ í•­ëª©:
  - ì˜ì–´ ë©”íƒ€ ì£¼ì„ ê´„í˜¸ ì œê±°: `(Answer: ...)`, `(Hint: ...)` ë“±
  - 3ë‹¨ì–´ ì´ìƒ ì˜ì–´ ë¬¸ì¥ ê´„í˜¸ ì œê±°: `(Solve for x)` ë“±
  - ë§ˆí¬ë‹¤ìš´ ì„œì‹ ì œê±°: `**bold**` â†’ `bold`
  - ë¬¸ì œ ë²ˆí˜¸ ì ‘ë‘ì–´ ì œê±°: `1.`, `Q1.`, `ë¬¸ì œ 1.` ë“±
  - ì—°ì† ê³µë°± ì •ë¦¬
- ìœ ì§€ ëŒ€ìƒ (ì œê±°í•˜ì§€ ì•ŠìŒ):
  - ìˆ˜í•™ ê´„í˜¸: `f(x)`, `(x+1)Â²`, `sin(Î¸)`
  - í•œêµ­ì–´ ë§ˆì»¤: `(ê°€)`, `(ë‚˜)`, `(ë‹¨, x > 0)`
  - ì§§ì€ ì˜ì–´ (3ë‹¨ì–´ ë¯¸ë§Œ)

### 2. 3ê°œ ì„œë¹„ìŠ¤ parseJSONì— ì •ì œ ì ìš©
- **GeminiService.js**: `parseJSON()`ì—ì„œ `question`, `problems[].question` ì •ì œ
- **ProblemGeneratorService.js**: `parseJSON()`ì—ì„œ `problems[].question` ì •ì œ
- **ImageAnalysisService.js**: `parseJSON()`ì—ì„œ `question` ì •ì œ

### 3. AI í”„ë¡¬í”„íŠ¸ì— í•œêµ­ì–´ ì „ìš© ê·œì¹™ ì¶”ê°€
- **GeminiService.js**: `analyzeImage`, `generateSimilarProblems`, `generateNewProblems` í”„ë¡¬í”„íŠ¸ 3ê³³
- **ProblemGeneratorService.js**: `buildGeneratePrompt`, `buildSciencePrompt`, `buildSimilarPrompt` í”„ë¡¬í”„íŠ¸ 3ê³³
- **ImageAnalysisService.js**: `buildPrompt` í”„ë¡¬í”„íŠ¸ 1ê³³
- ì¶”ê°€ ê·œì¹™: `questionì—ëŠ” ìˆœìˆ˜ ë¬¸ì œ í…ìŠ¤íŠ¸ë§Œ (ì˜ì–´ ë²ˆì—­, ë²ˆí˜¸, ë©”íƒ€ì •ë³´, ë§ˆí¬ë‹¤ìš´ ì„œì‹ ì œì™¸)`

### 4. ê¸°ì¡´ ì €ì¥ ë°ì´í„° ëŒ€ì‘
- **BattleScreen.js**: `questionText` ë³€ìˆ˜ì— `cleanQuestionText()` ì ìš©
- DBì— ì´ë¯¸ ì €ì¥ëœ ë¶ˆëŸ‰ ë°ì´í„°ë„ í‘œì‹œ ì‹œ ê¹¨ë—í•˜ê²Œ ì •ì œ

### 5. ì´ë¯¸ì§€ ë¬¸ì œ ì›ë³¸ í‘œì‹œ ê¸°ëŠ¥ ì¶”ê°€
- **BattleManager.js**: `showFullQuestion()` ëª¨ë‹¬ì— ì›ë³¸ ì´ë¯¸ì§€ í‘œì‹œ
  - `monster.imageData`ê°€ ìˆìœ¼ë©´ ë¬¸ì œ í…ìŠ¤íŠ¸ ìœ„ì— ì›ë³¸ ì´ë¯¸ì§€ ë Œë”ë§
  - ìµœëŒ€ ë†’ì´ 240px, ë¹„ìœ¨ ìœ ì§€, ë‘¥ê·¼ í…Œë‘ë¦¬
- **BattleScreen.js**: ì´ë¯¸ì§€ ë¬¸ì œëŠ” í¬ê²Œë³´ê¸° ì•„ì´ì½˜ì„ ğŸ“·ë¡œ ë³€ê²½ (ì¼ë°˜ ë¬¸ì œëŠ” ğŸ”)

### 6. ë“±ë¡ ë¬¸ì œ ë³´ê¸° ê¸°ëŠ¥ ì¶”ê°€
- **DialogManager.js**: `showProblemViewer()` ë©”ì„œë“œ ì‹ ê·œ ì¶”ê°€
  - DBì—ì„œ ì „ì²´ ë¬¸ì œ(alive + cleared) ì¡°íšŒ, ìµœì‹ ìˆœ ì •ë ¬
  - ì „ì²´í™”ë©´ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ HTML ëª¨ë‹¬
  - ê° ë¬¸ì œ ì¹´ë“œ: ê³¼ëª© ì•„ì´ì½˜, ìœ í˜•, ë‚œì´ë„, ì›ë³¸ ì´ë¯¸ì§€(ìˆìœ¼ë©´), ë¬¸ì œ í…ìŠ¤íŠ¸, ì •ë‹µ
  - ì´ë¯¸ì§€ í´ë¦­ ì‹œ í™•ëŒ€/ì¶•ì†Œ í† ê¸€
  - í•„í„° ë²„íŠ¼: ì „ì²´ / ì´ë¯¸ì§€ë§Œ
- **Game.js**: `showProblemViewer()` delegate ë©”ì„œë“œ ì¶”ê°€
- **MainScreen.js**: ğŸ‘¾ ëª¬ìŠ¤í„° ê°œìˆ˜ ì˜ì—­ í´ë¦­ ì‹œ ë¬¸ì œ ë³´ê¸° ì—´ë¦¼
- **i18n.js**: 4ê°œ ì–¸ì–´(í•œ/ì˜/ì¼/ì¤‘) ë²ˆì—­ í‚¤ ì¶”ê°€
  - `problemViewer`, `problemViewerEmpty`, `filterAll`, `filterImage`, `answerLabel`, `difficultyLabel`

### 7. Canvas ê¸°ë°˜ ë¬¸ì œ ì¹´ë“œ ì´ë¯¸ì§€ ìë™ ìƒì„±
- **textCleaner.js**: Canvas ê¸°ë°˜ `renderProblemCard()` í•¨ìˆ˜ ì¶”ê°€
  - API í˜¸ì¶œ ì—†ì´ ë¡œì»¬ Canvasë¡œ ì‹œí—˜ì§€ ìŠ¤íƒ€ì¼ ì¹´ë“œ ì´ë¯¸ì§€ ìƒì„±
  - ë¬¸ì œ í…ìŠ¤íŠ¸, ì„ íƒì§€(ì •ë‹µ í•˜ì´ë¼ì´íŠ¸), ì •ë‹µ, ê³¼ëª© ì•„ì´ì½˜ í‘œì‹œ
- **Game.js**: `_autoFillProblems()`ì—ì„œ `renderProblemCard()`ë¡œ ì´ë¯¸ì§€ ìë™ ìƒì„±
- **AIGenerateManager.js**: ìˆ˜ë™ AI ìƒì„± ì‹œì—ë„ `renderProblemCard()`ë¡œ ì´ë¯¸ì§€ ì¦‰ì‹œ ìƒì„±
- **DialogManager.js**: ë¬¸ì œ ë³´ê¸° ì—´ ë•Œ ì´ë¯¸ì§€ ì—†ëŠ” ë¬¸ì œì— ëŒ€í•´ Canvas ì¹´ë“œ ìë™ ìƒì„± í›„ DB ì €ì¥
- Gemini API ì´ë¯¸ì§€ ìƒì„± ì˜ì¡´ì„± ì™„ì „ ì œê±° â†’ Canvas ë¡œì»¬ ë Œë”ë§ìœ¼ë¡œ ì „í™˜

## ìˆ˜ì • íŒŒì¼ ëª©ë¡

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|-----------|
| `app/src/utils/textCleaner.js` | `cleanQuestionText()` + `renderProblemCard()` |
| `app/src/services/GeminiService.js` | parseJSON ì •ì œ + í”„ë¡¬í”„íŠ¸ 3ê³³ |
| `app/src/services/ProblemGeneratorService.js` | parseJSON ì •ì œ + í”„ë¡¬í”„íŠ¸ 3ê³³ |
| `app/src/services/ImageAnalysisService.js` | parseJSON ì •ì œ + í”„ë¡¬í”„íŠ¸ 1ê³³ |
| `app/src/game/screens/BattleScreen.js` | í‘œì‹œ ì‹œ ì •ì œ + ì´ë¯¸ì§€ ì•„ì´ì½˜ |
| `app/src/game/BattleManager.js` | í¬ê²Œë³´ê¸° ëª¨ë‹¬ì— ì›ë³¸ ì´ë¯¸ì§€ í‘œì‹œ |
| `app/src/game/DialogManager.js` | ë¬¸ì œ ë³´ê¸° ëª¨ë‹¬ + Canvas ì´ë¯¸ì§€ ìë™ ìƒì„± |
| `app/src/game/Game.js` | `showProblemViewer()` + ìë™ìƒì„± ì‹œ ì´ë¯¸ì§€ ìƒì„± |
| `app/src/game/AIGenerateManager.js` | ìˆ˜ë™ìƒì„± ì‹œ Canvas ì´ë¯¸ì§€ ì¦‰ì‹œ ìƒì„± |
| `app/src/game/screens/MainScreen.js` | ğŸ“‹ ë¬¸ì œ ë³´ê¸° ì „ìš© ë²„íŠ¼ ì¶”ê°€ |
| `app/src/i18n/i18n.js` | 4ê°œ ì–¸ì–´ ë²ˆì—­ í‚¤ ì¶”ê°€ |

## ê²€ì¦
- `npx vite build` ë¹Œë“œ ì„±ê³µ í™•ì¸
